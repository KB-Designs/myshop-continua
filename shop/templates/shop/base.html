{% load static %}
<!DOCTYPE html>
<html class="bg-white text-gray-800">
<head>
    <meta charset="utf-8" />
    <title>{% block title %}My shop{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://kit.fontawesome.com/YOUR_KIT_CODE.js" crossorigin="anonymous"></script>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-md fixed top-0 left-0 w-full z-50">
        <div class="container mx-auto flex justify-between items-center p-4">

            <!-- Logo -->
            <a href="{% url 'shop:product_list' %}" class="text-2xl font-bold hover:text-blue-200">
                InstaMart
            </a>

            <!-- Search Form -->
            <form action="{% url 'shop:product_search' %}" method="get" class="flex items-center bg-white rounded-lg overflow-hidden shadow-md w-1/3">
                <input type="text" name="q" placeholder="Search products..."
                       class="px-3 py-2 text-gray-700 w-full focus:outline-none"
                       value="{{ request.GET.q|default:'' }}">
                <button type="submit" class="px-4 bg-blue-500 text-white hover:bg-blue-700 transition">
                    <i class="fas fa-search"></i>
                </button>
            </form>

            <!-- Right Side: Cart + User -->
            <div class="flex items-center space-x-6">

                <!-- Cart -->
                <div class="cart text-sm">
                    {% with total_items=cart|length %}
                        <a href="{% url 'cart:cart_detail' %}" class="flex items-center space-x-2 hover:underline">
                            <div class="relative">
                                <svg xmlns="http://www.w3.org/2000/svg" 
                                     class="h-6 w-6 text-white" 
                                     fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" 
                                          stroke-linejoin="round" 
                                          stroke-width="2" 
                                          d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13l-1.5 7h13L17 13M7 13H3" />
                                </svg>
                                {% if total_items > 0 %}
                                    <span class="absolute -top-2 -right-2 bg-red-500 text-white text-[10px] rounded-full min-w-[1rem] h-4 px-1 flex items-center justify-center leading-none">
                                        {{ total_items }}
                                    </span>
                                {% endif %}
                            </div>
                            <span class="text-white font-medium">Cart</span>
                        </a>
                    {% endwith %}
                </div>

                <!-- User Account -->
                <div class="flex items-center space-x-4">
                    {% if user.is_authenticated %}
                        <!-- Show username -->
                        <span class="font-medium">Hi, {{ user.username }}</span>

                        <!-- Logout Button (POST) -->
                        <form method="post" action="{% url 'accounts:logout' %}">
                            {% csrf_token %}
                            <button type="submit" 
                                    class="flex items-center space-x-2 hover:text-blue-200 transition">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Logout</span>
                            </button>
                        </form>
                    {% else %}
                        <!-- Show Login / Signup -->
                        <a href="{% url 'accounts:login' %}" class="flex items-center space-x-2 hover:text-blue-200">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>Login</span>
                        </a>
                        <a href="{% url 'accounts:signup' %}" class="flex items-center space-x-2 hover:text-blue-200">
                            <i class="fas fa-user-plus"></i>
                            <span>Sign Up</span>
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </header>

    <!-- Spacer for fixed header -->
    <div class="h-20"></div>

    <!-- Messages -->
    {% if messages %}
    <div class="container mx-auto mt-4">
        <ul class="space-y-2">
            {% for message in messages %}
            <li class="p-3 rounded text-white {% if message.tags == 'success' %}bg-green-500{% elif message.tags == 'error' %}bg-red-500{% else %}bg-gray-500{% endif %}">
                {{ message }}
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- Main content -->
    <main class="container mx-auto flex-1 p-4">
        {% block content %}
        {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-blue-600 text-white py-6 mt-8">
        <div class="container mx-auto px-4 flex flex-col md:flex-row items-center justify-between">
            <div class="mb-4 md:mb-0">
                <span class="font-semibold text-lg">&copy; {{ now|date:"Y" }} InstaMart</span>  
                <span class="text-sm block">All rights reserved.</span>
            </div>
            <div class="flex space-x-6 mb-4 md:mb-0">
                <a href="#" class="hover:underline text-sm">About Us</a>
                <a href="#" class="hover:underline text-sm">Contact</a>
                <a href="#" class="hover:underline text-sm">Privacy Policy</a>
                <a href="#" class="hover:underline text-sm">Terms of Service</a>
            </div>
            <div class="flex space-x-3">
                <a href="https://facebook.com" target="_blank" 
                   class="bg-white text-blue-600 p-2 rounded-full hover:bg-gray-200 transition">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://twitter.com" target="_blank" 
                   class="bg-white text-blue-600 p-2 rounded-full hover:bg-gray-200 transition">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="https://linkedin.com" target="_blank" 
                   class="bg-white text-blue-600 p-2 rounded-full hover:bg-gray-200 transition">
                    <i class="fab fa-linkedin-in"></i>
                </a>
                <a href="https://tiktok.com" target="_blank" 
                   class="bg-white text-blue-600 p-2 rounded-full hover:bg-gray-200 transition">
                    <i class="fab fa-tiktok"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- Font Awesome CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/YOUR_KIT_CODE.js" crossorigin="anonymous"></script>

</body>
</html>
