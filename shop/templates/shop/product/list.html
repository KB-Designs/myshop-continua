{% extends "shop/base.html" %}
{% load static %}
{% load i18n %}

{% block title %}
  {% if category %}{{ category.name }}{% else %}Products{% endif %}
{% endblock %}

{% block content %}
<div class="flex flex-col md:flex-row gap-6">
  
  <!-- Sidebar -->
  <aside class="w-full md:w-1/4 bg-white shadow rounded-xl p-4">
    <h3 class="text-lg font-semibold text-blue-700 border-b pb-2 mb-4">Categories</h3>
    <ul class="space-y-2">
      <li {% if not category %}class="font-semibold text-blue-600"{% endif %}>
        <a href="{% url 'shop:product_list' %}" class="hover:text-blue-500 transition">
          All
        </a>
      </li>
      {% for c in categories %}
      <li {% if category.slug == c.slug %}class="font-semibold text-blue-600"{% endif %}>
        <a href="{{ c.get_absolute_url }}" class="hover:text-blue-500 transition">
          {{ c.name }}
        </a>
      </li>
      {% endfor %}
    </ul>
  </aside>

  <!-- Main Products -->
  <main class="w-full md:w-3/4">
    <h1 class="text-2xl font-bold text-blue-800 mb-6">
      {% if category %}{{ category.name }}{% else %}Products{% endif %}
    </h1>
    
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {% if products %}
        {% for product in products %}
        <div class="bg-white shadow rounded-xl overflow-hidden hover:shadow-lg transition">
          <a href="{{ product.get_absolute_url }}">
            <img src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'img/no_image.png' %}{% endif %}" 
                 alt="{{ product.name }}" 
                 class="w-full h-48 object-cover">
          </a>
          <div class="p-4">
            <a href="{{ product.get_absolute_url }}" class="block text-lg font-semibold text-blue-700 hover:underline">
              {{ product.name }}
            </a>
            <p class="text-gray-700 font-medium mt-2">Ksh.{{ product.price }}</p>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <p class="text-gray-600 italic col-span-full">No products found in this category.</p>
      {% endif %}
    </div>
  </main>
</div>
{% endblock %}
